name: bun-runtime
version: 1.0.0
description: Bun runtime with standard configuration
author: workspace-recipes
license: MIT
tags:
  - runtime
  - javascript
  - typescript
  - bun

conflicts:
  - node-runtime
  - deno-runtime

generates:
  - path: package.json
    content: |
      {
        "name": "{{ project_name }}",
        "type": "module",
        "scripts": {
          "dev": "bun run --watch src/index.ts",
          "start": "bun run src/index.ts"
        }
      }
    overwrite: false

  - path: .gitignore
    append: |

      # Bun
      bun.lockb
      node_modules/

  - path: src/index.ts
    content: |
      console.log("Hello from Bun!");
    overwrite: false

commands:
  dev:
    run: bun run --watch src/index.ts
    description: Run in development mode with hot reload

  start:
    run: bun run src/index.ts
    description: Run the application

  install:
    run: bun install
    description: Install dependencies

validates:
  - check: command_succeeds
    command: bun --version
    message: Bun is not installed. Install from https://bun.sh

  - check: file_exists
    path: package.json
    message: package.json is missing

hooks:
  post_apply:
    - command: bun install

# Recipe author tests
tests:
  - name: creates package.json
    assert_file_exists: package.json

  - name: package.json has correct type
    assert_json_field:
      path: package.json
      field: type
      equals: "module"

  - name: creates src/index.ts
    assert_file_exists: src/index.ts

  - name: index.ts has hello message
    assert_file_contains:
      path: src/index.ts
      contains: "Hello from Bun"

  - name: gitignore includes node_modules
    assert_file_contains:
      path: .gitignore
      contains: "node_modules/"
